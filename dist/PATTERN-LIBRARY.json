{
  "version": "1.0.0",
  "generated": "2026-01-10T01:28:53Z",
  "summary": {
    "total_patterns": 29,
    "enabled": 29,
    "disabled": 0,
    "by_severity": {
      "CRITICAL": 9,
      "HIGH": 10,
      "MEDIUM": 7,
      "LOW": 3
    },
    "by_category": {
      "performance": 9,"duplication": 5,"reliability": 5,"security": 8
    },
    "by_pattern_type": {
      "php": 18,
      "headless": 6,
      "nodejs": 4,
      "javascript": 1
    },
    "mitigation_detection_enabled": 4,
    "heuristic_patterns": 10,
    "definitive_patterns": 19
  },
  "patterns": [
    {
  "id": "array-merge-in-loop",
  "version": "1.0.0",
  "enabled": true,
  "category": "performance",
  "severity": "LOW",
  "title": "array_merge() inside loops (potential OOM)",
  "description": "Detects patterns like $arr = array_merge($arr, $new) inside loops, which can cause quadratic memory/time growth.",
  "detection_type": "grep",
  "pattern_type": "php",
  "mitigation_detection": false,
  "heuristic": true,
  "file": "array-merge-in-loop.json"
},
{
  "id": "duplicate-capability-strings",
  "version": "1.0.0",
  "enabled": true,
  "category": "duplication",
  "severity": "LOW",
  "title": "Duplicate capability strings across files",
  "description": "Detects current_user_can() and user_can() calls with hard-coded capability strings appearing in many files. While some duplication is normal (e.g., 'manage_options'), excessive duplication suggests capability checks should be centralized.",
  "detection_type": "aggregated",
  "pattern_type": "php",
  "mitigation_detection": false,
  "heuristic": true,
  "file": "duplicate-capability-strings.json"
},
{
  "id": "duplicate-functions",
  "version": "1.0.0",
  "enabled": true,
  "category": "duplication",
  "severity": "MEDIUM",
  "title": "Duplicate function definitions across files",
  "description": "Detects exact function clones (Type 1) using hash-based comparison of normalized function bodies. Functions with identical logic (after removing comments and normalizing whitespace) appearing in multiple files indicate copy-paste violations.",
  "detection_type": "clone_detection",
  "pattern_type": "php",
  "mitigation_detection": false,
  "heuristic": true,
  "file": "duplicate-functions.json"
},
{
  "id": "duplicate-option-names",
  "version": "1.0.0",
  "enabled": true,
  "category": "duplication",
  "severity": "MEDIUM",
  "title": "Duplicate option names across files",
  "description": "Detects get_option(), update_option(), and delete_option() calls with hard-coded option names appearing in multiple files. This indicates a DRY violation where option names should be centralized as constants.",
  "detection_type": "aggregated",
  "pattern_type": "php",
  "mitigation_detection": false,
  "heuristic": true,
  "file": "duplicate-option-names.json"
},
{
  "id": "duplicate-transient-keys",
  "version": "1.0.0",
  "enabled": true,
  "category": "duplication",
  "severity": "MEDIUM",
  "title": "Duplicate transient keys across files",
  "description": "Detects get_transient(), set_transient(), and delete_transient() calls with hard-coded transient keys appearing in multiple files. This indicates a DRY violation where transient keys should be centralized as constants.",
  "detection_type": "aggregated",
  "pattern_type": "php",
  "mitigation_detection": false,
  "heuristic": true,
  "file": "duplicate-transient-keys.json"
},
{
  "id": "get-users-no-limit",
  "version": "1.0.0",
  "enabled": true,
  "category": "performance",
  "severity": "CRITICAL",
  "title": "get_users() without 'number' limit",
  "description": "Detects get_users() calls without the 'number' parameter, which can fetch ALL users from the database and cause memory exhaustion on large sites.",
  "detection_type": "direct",
  "pattern_type": "php",
  "mitigation_detection": true,
  "heuristic": false,
  "file": "get-users-no-limit.json"
},
{
  "id": "headless-api-key-exposure",
  "version": "1.0.0",
  "enabled": true,
  "category": "security",
  "severity": "CRITICAL",
  "title": "API keys/secrets exposed in client-side code",
  "description": "Detects API keys, secrets, tokens, or passwords that may be exposed in client-side JavaScript bundles. In headless WordPress setups, this commonly happens with NEXT_PUBLIC_ environment variables containing sensitive values.",
  "detection_type": "direct",
  "pattern_type": "headless",
  "mitigation_detection": false,
  "heuristic": false,
  "file": "api-key-exposure.json"
},
{
  "id": "headless-fetch-no-error-handling",
  "version": "1.0.0",
  "enabled": true,
  "category": "reliability",
  "severity": "HIGH",
  "title": "fetch/axios calls without error handling",
  "description": "Detects fetch() or axios calls to WordPress REST API endpoints without proper error handling. Missing error handling leads to silent failures, broken UIs, and poor user experience.",
  "detection_type": "direct",
  "pattern_type": "headless",
  "mitigation_detection": false,
  "heuristic": false,
  "file": "fetch-no-error-handling.json"
},
{
  "id": "headless-graphql-no-error-handling",
  "version": "1.0.0",
  "enabled": true,
  "category": "reliability",
  "severity": "HIGH",
  "title": "GraphQL queries/mutations without error handling",
  "description": "Detects Apollo Client useQuery/useMutation hooks without error handling. Missing error handling in GraphQL operations leads to silent failures and broken UIs.",
  "detection_type": "direct",
  "pattern_type": "headless",
  "mitigation_detection": false,
  "heuristic": false,
  "file": "graphql-no-error-handling.json"
},
{
  "id": "headless-hardcoded-wordpress-url",
  "version": "1.0.0",
  "enabled": true,
  "category": "maintainability",
  "severity": "MEDIUM",
  "title": "Hardcoded WordPress API URL",
  "description": "Detects hardcoded WordPress REST API or GraphQL URLs instead of environment variables. Hardcoded URLs break deployments across different environments (dev, staging, production).",
  "detection_type": "direct",
  "pattern_type": "headless",
  "mitigation_detection": false,
  "heuristic": true,
  "file": "hardcoded-wordpress-url.json"
},
{
  "id": "headless-missing-auth-headers",
  "version": "1.0.0",
  "enabled": true,
  "category": "security",
  "severity": "HIGH",
  "title": "WordPress REST API calls missing authentication",
  "description": "Detects fetch/axios calls to WordPress REST API endpoints that modify data (POST, PUT, DELETE) without proper authentication headers or credentials mode.",
  "detection_type": "direct",
  "pattern_type": "headless",
  "mitigation_detection": false,
  "heuristic": false,
  "file": "missing-auth-headers.json"
},
{
  "id": "headless-nextjs-missing-revalidate",
  "version": "1.0.0",
  "enabled": true,
  "category": "performance",
  "severity": "MEDIUM",
  "title": "Next.js getStaticProps without revalidate (stale WordPress data)",
  "description": "Detects Next.js getStaticProps that fetch WordPress data but don't include a revalidate property, causing WordPress content to never update after initial build.",
  "detection_type": "direct",
  "pattern_type": "headless",
  "mitigation_detection": false,
  "heuristic": true,
  "file": "nextjs-missing-revalidate.json"
},
{
  "id": "duplicate-storage-keys",
  "version": "1.0.0",
  "enabled": true,
  "category": "duplication",
  "severity": "LOW",
  "title": "Duplicate localStorage/sessionStorage keys across files",
  "description": "Detects storage keys that appear in multiple JavaScript files. Duplicate storage keys indicate potential key collisions or inconsistent key management.",
  "detection_type": "aggregated",
  "pattern_type": "javascript",
  "mitigation_detection": false,
  "heuristic": true,
  "file": "duplicate-storage-keys.json"
},
{
  "id": "limit-multiplier-from-count",
  "version": "1.0.0",
  "enabled": true,
  "category": "performance",
  "severity": "MEDIUM",
  "title": "Query limit multiplier derived from count()",
  "description": "Detects patterns like count($ids) * N used to derive query limits/candidate limits. This can multiply unexpectedly and trigger OOM when combined with object hydration.",
  "detection_type": "grep",
  "pattern_type": "php",
  "mitigation_detection": false,
  "heuristic": true,
  "file": "limit-multiplier-from-count.json"
},
{
  "id": "njs-002-command-injection",
  "version": "1.0.0",
  "enabled": true,
  "category": "security",
  "severity": "CRITICAL",
  "title": "Potential command injection (child_process)",
  "description": "Detects usage of child_process.exec, execSync, or spawn with shell:true that may be vulnerable to command injection.",
  "detection_type": "direct",
  "pattern_type": "nodejs",
  "mitigation_detection": false,
  "heuristic": false,
  "file": "command-injection.json"
},
{
  "id": "njs-001-eval-injection",
  "version": "1.0.0",
  "enabled": true,
  "category": "security",
  "severity": "CRITICAL",
  "title": "Dangerous eval() or code execution",
  "description": "Detects usage of eval(), Function constructor, and other code execution patterns that can lead to code injection vulnerabilities.",
  "detection_type": "direct",
  "pattern_type": "nodejs",
  "mitigation_detection": false,
  "heuristic": false,
  "file": "eval-injection.json"
},
{
  "id": "njs-003-path-traversal",
  "version": "1.0.0",
  "enabled": true,
  "category": "security",
  "severity": "HIGH",
  "title": "Potential path traversal in fs operations",
  "description": "Detects file system operations that may be vulnerable to path traversal attacks via '../' sequences in user input.",
  "detection_type": "direct",
  "pattern_type": "nodejs",
  "mitigation_detection": false,
  "heuristic": false,
  "file": "path-traversal.json"
},
{
  "id": "njs-004-unhandled-promise",
  "version": "1.0.0",
  "enabled": true,
  "category": "reliability",
  "severity": "HIGH",
  "title": "Promise without error handling",
  "description": "Detects promises that lack .catch() handlers or async functions without try/catch blocks, which can lead to unhandled promise rejections.",
  "detection_type": "direct",
  "pattern_type": "nodejs",
  "mitigation_detection": false,
  "heuristic": false,
  "file": "unhandled-promise.json"
},
{
  "id": "superglobal-with-nonce-context",
  "version": "1.0.0",
  "enabled": true,
  "category": "security",
  "severity": "HIGH",
  "title": "Context-aware superglobal detection with nonce verification",
  "description": "Enhanced detection that checks for nonce verification before $_POST/$_GET access. Skips findings when proper nonce + sanitization pattern is detected.",
  "detection_type": "context-aware",
  "pattern_type": "php",
  "mitigation_detection": false,
  "heuristic": false,
  "file": "superglobal-with-nonce-context.json"
},
{
  "id": "unbounded-wc-get-orders",
  "version": "1.0.0",
  "enabled": true,
  "category": "performance",
  "severity": "CRITICAL",
  "title": "Unbounded wc_get_orders()",
  "description": "Detects wc_get_orders() calls with explicit 'limit' => -1, which hydrates full WC_Order objects indefinitely and causes OOM crashes.",
  "detection_type": "grep",
  "pattern_type": "php",
  "mitigation_detection": true,
  "heuristic": false,
  "file": "unbounded-wc-get-orders.json"
},
{
  "id": "unbounded-wc-get-products",
  "version": "1.0.0",
  "enabled": true,
  "category": "performance",
  "severity": "CRITICAL",
  "title": "Unbounded wc_get_products()",
  "description": "Detects wc_get_products() calls with explicit 'limit' => -1.",
  "detection_type": "grep",
  "pattern_type": "php",
  "mitigation_detection": false,
  "heuristic": false,
  "file": "unbounded-wc-get-products.json"
},
{
  "id": "unsanitized-superglobal-isset-bypass",
  "version": "1.0.0",
  "enabled": true,
  "category": "security",
  "severity": "HIGH",
  "title": "Unsanitized superglobal read ($_GET/$_POST)",
  "description": "Detects $_GET/$_POST/$_REQUEST used directly after isset/empty check on same line without sanitization",
  "detection_type": "direct",
  "pattern_type": "php",
  "mitigation_detection": false,
  "heuristic": false,
  "file": "unsanitized-superglobal-isset-bypass.json"
},
{
  "id": "unsanitized-superglobal-read",
  "version": "1.0.0",
  "enabled": true,
  "category": "security",
  "severity": "HIGH",
  "title": "Unsanitized superglobal read ($_GET/$_POST/$_REQUEST)",
  "description": "Direct access to $_GET, $_POST, or $_REQUEST without sanitization functions. Unlike the isset-bypass pattern, this catches ANY unsanitized access regardless of isset/empty checks.",
  "detection_type": "direct",
  "pattern_type": "php",
  "mitigation_detection": false,
  "heuristic": false,
  "file": "unsanitized-superglobal-read.json"
},
{
  "id": "wc-coupon-in-thankyou",
  "version": "1.0.0",
  "enabled": true,
  "category": "reliability",
  "severity": "HIGH",
  "title": "Coupon logic in WooCommerce thank-you/order-received context",
  "description": "Detects coupon-related operations (apply_coupon, remove_coupon, WC_Coupon instantiation) in WooCommerce thank-you or order-received contexts. This is a reliability anti-pattern because the order is already complete and coupon operations should not be performed post-checkout.",
  "detection_type": "direct",
  "pattern_type": "php",
  "mitigation_detection": false,
  "heuristic": false,
  "file": "wc-coupon-in-thankyou.json"
},
{
  "id": "wc-smart-coupons-thankyou-perf",
  "version": "1.0.0",
  "enabled": true,
  "category": "performance",
  "severity": "HIGH",
  "title": "WooCommerce Smart Coupons active with potential thank-you page performance impact",
  "description": "Detects WooCommerce Smart Coupons plugin which is known to trigger expensive database queries (LOWER(post_title) lookups) on the thank-you/order-received page. This can cause 15-30 second page load times on sites with large wp_posts tables.",
  "detection_type": "direct",
  "pattern_type": "php",
  "mitigation_detection": false,
  "heuristic": false,
  "file": "wc-smart-coupons-thankyou-perf.json"
},
{
  "id": "wp-json-html-escape",
  "version": "",
  "enabled": true,
  "category": "reliability",
  "severity": "MEDIUM",
  "title": "HTML-escaping in JSON response URL fields",
  "description": "Detects HTML escaping functions (esc_url, esc_attr, esc_html) used in JSON response fields with URL-like names. This can cause double-encoding issues where & becomes &#038; breaking redirects in JavaScript.",
  "detection_type": "",
  "pattern_type": "php",
  "mitigation_detection": false,
  "heuristic": true,
  "file": "wp-json-html-escape.json"
},
{
  "id": "wp-query-unbounded",
  "version": "1.0.0",
  "enabled": true,
  "category": "performance",
  "severity": "CRITICAL",
  "title": "Unbounded WP_Query/get_posts",
  "description": "Detects WP_Query or get_posts with posts_per_page => -1 or nopaging => true.",
  "detection_type": "grep",
  "pattern_type": "php",
  "mitigation_detection": true,
  "heuristic": false,
  "file": "wp-query-unbounded.json"
},
{
  "id": "wp-user-query-meta-bloat",
  "version": "1.0.0",
  "enabled": true,
  "category": "performance",
  "severity": "CRITICAL",
  "title": "WP_User_Query Full Meta Hydration",
  "description": "Detects WP_User_Query without 'update_user_meta_cache' => false.",
  "detection_type": "grep",
  "pattern_type": "php",
  "mitigation_detection": true,
  "heuristic": false,
  "file": "wp-user-query-meta-bloat.json"
},
{
  "id": "wpdb-query-no-prepare",
  "version": "1.0.0",
  "enabled": true,
  "category": "security",
  "severity": "CRITICAL",
  "title": "Direct database queries without $wpdb->prepare()",
  "description": "Detects $wpdb->query(), get_var(), get_row(), get_results(), or get_col() called without $wpdb->prepare() wrapper, creating SQL injection vulnerabilities.",
  "detection_type": "direct",
  "pattern_type": "php",
  "mitigation_detection": false,
  "heuristic": false,
  "file": "wpdb-query-no-prepare.json"
}
  ]
}
