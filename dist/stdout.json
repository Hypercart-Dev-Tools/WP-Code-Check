{
  "version": "2.0.1",
  "timestamp": "2026-01-17T22:51:50Z",
  "project": {
    "type": "fixture",
    "name": "antipatterns.php",
    "version": "",
    "description": "",
    "author": "",
    "path": "/Users/noelsaw/Documents/GH Repos/wp-code-check/dist/tests/fixtures/antipatterns.php",
    "files_analyzed": 1,
    "lines_of_code": 402
  },
  "paths_scanned": "./tests/fixtures/antipatterns.php",
  "strict_mode": false,
  "summary": {
    "total_errors": 9,
    "total_warnings": 2,
    "magic_string_violations": 0,
    "clone_detection_ran": false,
    "files_analyzed": 1,
    "lines_of_code": 402,
    "baselined": 0,
    "stale_baseline": 0,
    "exit_code": 1
  },
  "fixture_validation": {
    "status": "passed",
    "passed": 20,
    "failed": 0,
    "message": "Detection patterns verified against 20 test fixtures"
  },
  "findings": [{"id":"wpdb-query-no-prepare","severity":"error","impact":"MEDIUM","file":"./tests/fixtures/antipatterns.php","line":170,"message":"Direct database query without $wpdb->prepare() (literal SQL - best practice)","code":"    return $wpdb->get_results( \"SELECT * FROM {$wpdb->posts} WHERE post_type = 'product' ORDER BY RAND() LIMIT 5\" );","context":[{"line":167,"code":"function get_random_products_sql_bad() {"},{"line":168,"code":"    global $wpdb;"},{"line":169,"code":"    // ðŸš¨ ANTIPATTERN: ORDER BY RAND() causes full scan"},{"line":171,"code":"}"},{"line":173,"code":"// ============================================================"}],"guards":[],"sanitizers":[]},{"id":"wpdb-query-no-prepare","severity":"error","impact":"MEDIUM","file":"./tests/fixtures/antipatterns.php","line":210,"message":"Direct database query without $wpdb->prepare() (literal SQL - best practice)","code":"    return $wpdb->get_results( \"SELECT * FROM {$wpdb->terms} WHERE name LIKE '%test%'\" );","context":[{"line":207,"code":"function get_all_terms_sql_bad() {"},{"line":208,"code":"    global $wpdb;"},{"line":209,"code":"    // ðŸš¨ ANTIPATTERN: No LIMIT on terms table"},{"line":211,"code":"}"},{"line":213,"code":"/**"}],"guards":[],"sanitizers":[]},{"id":"wpdb-query-no-prepare","severity":"error","impact":"MEDIUM","file":"./tests/fixtures/antipatterns.php","line":218,"message":"Direct database query without $wpdb->prepare() (literal SQL - best practice)","code":"    return $wpdb->get_results( \"SELECT * FROM {$wpdb->terms} WHERE name LIKE '%test%' LIMIT 100\" );","context":[{"line":215,"code":" */"},{"line":216,"code":"function get_terms_sql_good() {"},{"line":217,"code":"    global $wpdb;"},{"line":219,"code":"}"},{"line":221,"code":"// ============================================================"}],"guards":[],"sanitizers":[]},{"id":"wpdb-query-no-prepare","severity":"error","impact":"MEDIUM","file":"./tests/fixtures/antipatterns.php","line":352,"message":"Direct database query without $wpdb->prepare() (literal SQL - best practice)","code":"    return $wpdb->get_results(","context":[{"line":349,"code":"function search_postmeta_bad( $search_term ) {"},{"line":350,"code":"    global $wpdb;"},{"line":351,"code":"    // ðŸš¨ ANTIPATTERN: LIKE with leading wildcard"},{"line":353,"code":"        $wpdb->prepare("},{"line":354,"code":"            \"SELECT * FROM {$wpdb->postmeta} WHERE meta_value LIKE %s LIMIT 100\","},{"line":355,"code":"            '%' . $search_term . '%'"}],"guards":[],"sanitizers":[]},{"id":"unbounded-wc-get-orders","severity":"error","impact":"CRITICAL","file":"./tests/fixtures/antipatterns.php","line":57,"message":"Unbounded WooCommerce query (limit => -1)","code":"        'limit' => -1,  // ðŸš¨ ANTIPATTERN: Unbounded","context":[{"line":54,"code":" */"},{"line":55,"code":"function get_all_orders_bad() {"},{"line":56,"code":"    return wc_get_orders( array("},{"line":58,"code":"    ) );"},{"line":59,"code":"}"}],"guards":[],"sanitizers":[]},{"id":"unbounded-wc-get-orders","severity":"error","impact":"CRITICAL","file":"./tests/fixtures/antipatterns.php","line":56,"message":"wc_get_orders() with limit => -1 causes OOM","code":"    return wc_get_orders( array(","context":[{"line":53,"code":" * Risk: Memory exhaustion with large order counts"},{"line":54,"code":" */"},{"line":55,"code":"function get_all_orders_bad() {"},{"line":57,"code":"        'limit' => -1,  // ðŸš¨ ANTIPATTERN: Unbounded"},{"line":58,"code":"    ) );"},{"line":59,"code":"}"}],"guards":[],"sanitizers":[]},{"id":"wp-query-unbounded","severity":"error","impact":"CRITICAL","file":"./tests/fixtures/antipatterns.php","line":25,"message":"WP_Query/get_posts with -1 limit or nopaging","code":"    return new WP_Query( $args );","context":[{"line":22,"code":"        'posts_per_page' => -1,  // ðŸš¨ ANTIPATTERN: Unbounded"},{"line":23,"code":"        'post_status'    => 'publish',"},{"line":24,"code":"    );"},{"line":26,"code":"}"},{"line":28,"code":"/**"}],"guards":[],"sanitizers":[]},{"id":"wp-query-unbounded","severity":"error","impact":"CRITICAL","file":"./tests/fixtures/antipatterns.php","line":33,"message":"WP_Query/get_posts with -1 limit or nopaging","code":"    return get_posts( array(","context":[{"line":30,"code":" * Risk: Same as posts_per_page"},{"line":31,"code":" */"},{"line":32,"code":"function get_all_products_bad() {"},{"line":34,"code":"        'post_type'   => 'product',"},{"line":35,"code":"        'numberposts' => -1,  // ðŸš¨ ANTIPATTERN: Unbounded"},{"line":36,"code":"    ) );"}],"guards":[],"sanitizers":[]},{"id":"wp-query-unbounded","severity":"error","impact":"CRITICAL","file":"./tests/fixtures/antipatterns.php","line":44,"message":"WP_Query/get_posts with -1 limit or nopaging","code":"    $query = new WP_Query( array(","context":[{"line":41,"code":" * Risk: Disables all pagination limits"},{"line":42,"code":" */"},{"line":43,"code":"function get_everything_bad() {"},{"line":45,"code":"        'post_type' => 'any',"},{"line":46,"code":"        'nopaging'  => true,  // ðŸš¨ ANTIPATTERN: Disables limits"},{"line":47,"code":"    ) );"}],"guards":[],"sanitizers":[]},{"id":"n-plus-1-pattern","severity":"warning","impact":"CRITICAL","file":"./tests/fixtures/antipatterns.php","line":0,"message":"File may contain N+1 query pattern (meta in loops)","code":"","context":[{"line":1,"code":"<?php"},{"line":2,"code":"/**"},{"line":3,"code":" * Test Fixture: Antipatterns"}],"guards":[],"sanitizers":[]},{"id":"duplicate-transient-keys","severity":"error","impact":"MEDIUM","file":"./tests/fixtures/antipatterns.php","line":254,"message":"Duplicate transient keys across files","code":"    set_transient( 'my_cached_data', $data );","context":[{"line":251,"code":"function cache_data_without_expiration_bad() {"},{"line":252,"code":"    $data = get_expensive_data();"},{"line":253,"code":"    // ðŸš¨ ANTIPATTERN: Missing third parameter (expiration)"},{"line":255,"code":"    return $data;"},{"line":256,"code":"}"}],"guards":[],"sanitizers":[]},{"id":"duplicate-transient-keys","severity":"error","impact":"MEDIUM","file":"./tests/fixtures/antipatterns.php","line":264,"message":"Duplicate transient keys across files","code":"    set_transient( 'user_prefs_' . $user_id, $prefs );","context":[{"line":261,"code":" */"},{"line":262,"code":"function store_user_preferences_bad( $user_id, $prefs ) {"},{"line":263,"code":"    // ðŸš¨ ANTIPATTERN: Only 2 parameters, missing expiration"},{"line":265,"code":"}"},{"line":267,"code":"/**"}],"guards":[],"sanitizers":[]},{"id":"duplicate-transient-keys","severity":"error","impact":"MEDIUM","file":"./tests/fixtures/antipatterns.php","line":273,"message":"Duplicate transient keys across files","code":"    set_transient( 'my_cached_data', $data, HOUR_IN_SECONDS );","context":[{"line":270,"code":"function cache_data_with_expiration_good() {"},{"line":271,"code":"    $data = get_expensive_data();"},{"line":272,"code":"    // âœ… Has expiration (1 hour)"},{"line":274,"code":"    return $data;"},{"line":275,"code":"}"}],"guards":[],"sanitizers":[]},{"id":"wpdb-query-no-prepare","severity":"error","impact":"CRITICAL","file":"./tests/fixtures/antipatterns.php","line":170,"message":"Direct database queries without $wpdb->prepare()","code":"    return $wpdb->get_results( \"SELECT * FROM {$wpdb->posts} WHERE post_type = 'product' ORDER BY RAND() LIMIT 5\" );","context":[{"line":167,"code":"function get_random_products_sql_bad() {"},{"line":168,"code":"    global $wpdb;"},{"line":169,"code":"    // ðŸš¨ ANTIPATTERN: ORDER BY RAND() causes full scan"},{"line":171,"code":"}"},{"line":173,"code":"// ============================================================"}],"guards":[],"sanitizers":[]},{"id":"wpdb-query-no-prepare","severity":"error","impact":"CRITICAL","file":"./tests/fixtures/antipatterns.php","line":210,"message":"Direct database queries without $wpdb->prepare()","code":"    return $wpdb->get_results( \"SELECT * FROM {$wpdb->terms} WHERE name LIKE '%test%'\" );","context":[{"line":207,"code":"function get_all_terms_sql_bad() {"},{"line":208,"code":"    global $wpdb;"},{"line":209,"code":"    // ðŸš¨ ANTIPATTERN: No LIMIT on terms table"},{"line":211,"code":"}"},{"line":213,"code":"/**"}],"guards":[],"sanitizers":[]},{"id":"wpdb-query-no-prepare","severity":"error","impact":"CRITICAL","file":"./tests/fixtures/antipatterns.php","line":218,"message":"Direct database queries without $wpdb->prepare()","code":"    return $wpdb->get_results( \"SELECT * FROM {$wpdb->terms} WHERE name LIKE '%test%' LIMIT 100\" );","context":[{"line":215,"code":" */"},{"line":216,"code":"function get_terms_sql_good() {"},{"line":217,"code":"    global $wpdb;"},{"line":219,"code":"}"},{"line":221,"code":"// ============================================================"}],"guards":[],"sanitizers":[]},{"id":"wpdb-query-no-prepare","severity":"error","impact":"CRITICAL","file":"./tests/fixtures/antipatterns.php","line":352,"message":"Direct database queries without $wpdb->prepare()","code":"    return $wpdb->get_results(","context":[{"line":349,"code":"function search_postmeta_bad( $search_term ) {"},{"line":350,"code":"    global $wpdb;"},{"line":351,"code":"    // ðŸš¨ ANTIPATTERN: LIKE with leading wildcard"},{"line":353,"code":"        $wpdb->prepare("},{"line":354,"code":"            \"SELECT * FROM {$wpdb->postmeta} WHERE meta_value LIKE %s LIMIT 100\","},{"line":355,"code":"            '%' . $search_term . '%'"}],"guards":[],"sanitizers":[]},{"id":"unbounded-wc-get-orders","severity":"error","impact":"CRITICAL","file":"./tests/fixtures/antipatterns.php","line":56,"message":"Unbounded wc_get_orders()","code":"    return wc_get_orders( array(","context":[{"line":53,"code":" * Risk: Memory exhaustion with large order counts"},{"line":54,"code":" */"},{"line":55,"code":"function get_all_orders_bad() {"},{"line":57,"code":"        'limit' => -1,  // ðŸš¨ ANTIPATTERN: Unbounded"},{"line":58,"code":"    ) );"},{"line":59,"code":"}"}],"guards":[],"sanitizers":[]},{"id":"unbounded-wc-get-orders","severity":"error","impact":"CRITICAL","file":"./tests/fixtures/antipatterns.php","line":100,"message":"Unbounded wc_get_orders()","code":"    return wc_get_orders( array(","context":[{"line":97,"code":"function get_recent_orders_bad() {"},{"line":98,"code":"    $one_week_ago = current_time( 'timestamp' ) - WEEK_IN_SECONDS;  // ðŸš¨ ANTIPATTERN"},{"line":101,"code":"        'date_created' => '>' . $one_week_ago,"},{"line":102,"code":"        'limit'        => 100,"},{"line":103,"code":"    ) );"}],"guards":[],"sanitizers":[]},{"id":"like-leading-wildcard","severity":"error","impact":"MEDIUM","file":"./tests/fixtures/antipatterns.php","line":210,"message":"LIKE queries with leading wildcards","code":"    return $wpdb->get_results( \"SELECT * FROM {$wpdb->terms} WHERE name LIKE '%test%'\" );","context":[{"line":207,"code":"function get_all_terms_sql_bad() {"},{"line":208,"code":"    global $wpdb;"},{"line":209,"code":"    // ðŸš¨ ANTIPATTERN: No LIMIT on terms table"},{"line":211,"code":"}"},{"line":213,"code":"/**"}],"guards":[],"sanitizers":[]},{"id":"like-leading-wildcard","severity":"error","impact":"MEDIUM","file":"./tests/fixtures/antipatterns.php","line":218,"message":"LIKE queries with leading wildcards","code":"    return $wpdb->get_results( \"SELECT * FROM {$wpdb->terms} WHERE name LIKE '%test%' LIMIT 100\" );","context":[{"line":215,"code":" */"},{"line":216,"code":"function get_terms_sql_good() {"},{"line":217,"code":"    global $wpdb;"},{"line":219,"code":"}"},{"line":221,"code":"// ============================================================"}],"guards":[],"sanitizers":[]},{"id":"like-leading-wildcard","severity":"error","impact":"MEDIUM","file":"./tests/fixtures/antipatterns.php","line":346,"message":"LIKE queries with leading wildcards","code":" * Antipattern 20: Raw SQL with LIKE '%...","context":[{"line":343,"code":"}"},{"line":345,"code":"/**"},{"line":347,"code":" * Risk: Full table scan on large tables"},{"line":348,"code":" */"},{"line":349,"code":"function search_postmeta_bad( $search_term ) {"}],"guards":[],"sanitizers":[]},{"id":"pre-get-posts-unbounded","severity":"error","impact":"CRITICAL","file":"./tests/fixtures/antipatterns.php","line":181,"message":"pre_get_posts Hook Sets Unbounded Query","code":"add_action( 'pre_get_posts', function( $query ) {","context":[{"line":178,"code":" * Antipattern 12: pre_get_posts setting posts_per_page to -1"},{"line":179,"code":" * Risk: Sitewide unbounded queries on main query"},{"line":180,"code":" */"},{"line":182,"code":"    if ( ! is_admin() && $query->is_main_query() && is_post_type_archive( 'product' ) ) {"},{"line":183,"code":"        // ðŸš¨ ANTIPATTERN: Unbounded main query"},{"line":184,"code":"        $query->set( 'posts_per_page', -1 );"}],"guards":[],"sanitizers":[]},{"id":"pre-get-posts-unbounded","severity":"error","impact":"CRITICAL","file":"./tests/fixtures/antipatterns.php","line":192,"message":"pre_get_posts Hook Sets Unbounded Query","code":"add_action( 'pre_get_posts', function( $query ) {","context":[{"line":189,"code":" * Antipattern 13: pre_get_posts setting nopaging to true"},{"line":190,"code":" * Risk: Disables pagination on main query"},{"line":191,"code":" */"},{"line":193,"code":"    if ( $query->is_search() ) {"},{"line":194,"code":"        // ðŸš¨ ANTIPATTERN: Disables pagination"},{"line":195,"code":"        $query->set( 'nopaging', true );"}],"guards":[],"sanitizers":[]},{"id":"wp-query-unbounded","severity":"error","impact":"HIGH","file":"./tests/fixtures/antipatterns.php","line":33,"message":"Unbounded WP_Query/get_posts [Mitigated by: pagination]","code":"    return get_posts( array(","context":[{"line":30,"code":" * Risk: Same as posts_per_page"},{"line":31,"code":" */"},{"line":32,"code":"function get_all_products_bad() {"},{"line":34,"code":"        'post_type'   => 'product',"},{"line":35,"code":"        'numberposts' => -1,  // ðŸš¨ ANTIPATTERN: Unbounded"},{"line":36,"code":"    ) );"}],"guards":[],"sanitizers":[]}],
  "checks": [{"name":"Debug code in production","impact":"CRITICAL","status":"passed","findings_count":0},{"name":"Sensitive data in localStorage/sessionStorage","impact":"CRITICAL","status":"passed","findings_count":0},{"name":"Serialization of objects to client storage","impact":"CRITICAL","status":"passed","findings_count":0},{"name":"User input in RegExp without escaping (HCC-008)","impact":"MEDIUM","status":"passed","findings_count":0},{"name":"Direct superglobal manipulation","impact":"HIGH","status":"passed","findings_count":0},{"name":"Unsanitized superglobal read ($_GET/$_POST)","impact":"HIGH","status":"passed","findings_count":0},{"name":"Insecure data deserialization","impact":"CRITICAL","status":"passed","findings_count":0},{"name":"Direct file write with user-controlled path","impact":"CRITICAL","status":"passed","findings_count":0},{"name":"Direct database queries without $wpdb->prepare()","impact":"CRITICAL","status":"failed","findings_count":4},{"name":"Admin functions without capability checks","impact":"HIGH","status":"passed","findings_count":0},{"name":"wp_ajax handlers without nonce validation","impact":"HIGH","status":"passed","findings_count":0},{"name":"Unbounded wc_get_orders/wc_get_products limit","impact":"CRITICAL","status":"failed","findings_count":1},{"name":"get_users without number limit","impact":"CRITICAL","status":"passed","findings_count":0},{"name":"get_terms without number limit","impact":"CRITICAL","status":"passed","findings_count":0},{"name":"Unbounded wc_get_orders()","impact":"CRITICAL","status":"failed","findings_count":1},{"name":"Unbounded wc_get_products()","impact":"CRITICAL","status":"passed","findings_count":0},{"name":"Unbounded WP_Query/get_posts","impact":"CRITICAL","status":"failed","findings_count":3},{"name":"WP_User_Query meta bloat","impact":"CRITICAL","status":"passed","findings_count":0},{"name":"Potential query limit multipliers (count() * N)","impact":"MEDIUM","status":"passed","findings_count":0},{"name":"Unvalidated cron intervals","impact":"HIGH","status":"passed","findings_count":0},{"name":"Potential N+1 patterns (meta in loops)","impact":"CRITICAL","status":"failed","findings_count":1},{"name":"WooCommerce N+1 patterns (WC functions in loops)","impact":"HIGH","status":"passed","findings_count":0},{"name":"WooCommerce coupon logic in thank-you context","impact":"HIGH","status":"passed","findings_count":0},{"name":"WooCommerce Smart Coupons performance issues","impact":"HIGH","status":"passed","findings_count":0},{"name":"HTML-escaping in JSON response URL fields (heuristic)","impact":"MEDIUM","status":"passed","findings_count":0},{"name":"Dangerous eval() usage in PHP","impact":"CRITICAL","status":"passed","findings_count":0},{"name":"Duplicate transient keys across files","impact":"MEDIUM","status":"failed","findings_count":3},{"name":"Direct file write with user-controlled path","impact":"CRITICAL","status":"passed","findings_count":0},{"name":"Direct database queries without $wpdb->prepare()","impact":"CRITICAL","status":"failed","findings_count":4},{"name":"Unsanitized superglobal read ($_GET/$_POST/$_REQUEST)","impact":"HIGH","status":"passed","findings_count":0},{"name":"Shell command execution functions in PHP (shell_exec/exec/system/passthru)","impact":"CRITICAL","status":"passed","findings_count":0},{"name":"Hardcoded credentials in PHP","impact":"CRITICAL","status":"passed","findings_count":0},{"name":"Duplicate capability strings across files","impact":"LOW","status":"passed","findings_count":0},{"name":"Unsanitized superglobal read ($_GET/$_POST)","impact":"HIGH","status":"passed","findings_count":0},{"name":"Unbounded wc_get_products()","impact":"CRITICAL","status":"passed","findings_count":0},{"name":"Query limit multiplier derived from count()","impact":"MEDIUM","status":"passed","findings_count":0},{"name":"Unbounded wc_get_orders()","impact":"CRITICAL","status":"failed","findings_count":2},{"name":"Duplicate option names across files","impact":"MEDIUM","status":"passed","findings_count":0},{"name":"WP_User_Query Full Meta Hydration","impact":"CRITICAL","status":"passed","findings_count":0},{"name":"Dynamic PHP include/require with variables","impact":"CRITICAL","status":"passed","findings_count":0},{"name":"LIKE queries with leading wildcards","impact":"MEDIUM","status":"failed","findings_count":3},{"name":"array_merge() inside loops (heuristic)","impact":"LOW","status":"passed","findings_count":0},{"name":"pre_get_posts Hook Sets Unbounded Query","impact":"CRITICAL","status":"failed","findings_count":2},{"name":"Unbounded AJAX polling (setInterval + fetch/ajax)","impact":"HIGH","status":"passed","findings_count":0},{"name":"Transients without expiration","impact":"MEDIUM","status":"passed","findings_count":0},{"name":"HTTP requests without timeout","impact":"MEDIUM","status":"passed","findings_count":0},{"name":"Unbounded SQL on wp_terms/wp_term_taxonomy","impact":"HIGH","status":"passed","findings_count":0},{"name":"Unbounded WP_Query/get_posts","impact":"CRITICAL","status":"failed","findings_count":1},{"name":"REST endpoints without pagination/limits","impact":"CRITICAL","status":"passed","findings_count":0},{"name":"Timezone-sensitive patterns (current_time/date)","impact":"LOW","status":"passed","findings_count":0},{"name":"WooCommerce Subscriptions queries without limits","impact":"MEDIUM","status":"passed","findings_count":0},{"name":"get_users() without 'number' limit","impact":"CRITICAL","status":"passed","findings_count":0},{"name":"Expensive WP functions in polling intervals (HCC-005)","impact":"HIGH","status":"passed","findings_count":0}],
  "magic_string_violations": []
}
