{
  "version": "1.0.68",
  "timestamp": "2026-01-01T05:32:10Z",
  "project": {
    "type": "unknown",
    "name": "wp-security-audit-log",
    "version": "",
    "description": "",
    "author": "",
    "path": "/Users/noelsaw/Documents/GH Repos/wp-code-check/dist/tests/irl/wp-security-audit-log",
    "files_analyzed": 3,
    "lines_of_code": 3663
  },
  "paths_scanned": "dist/tests/irl/wp-security-audit-log",
  "strict_mode": false,
  "summary": {
    "total_errors": 5,
    "total_warnings": 1,
    "files_analyzed": 3,
    "lines_of_code": 3663,
    "baselined": 0,
    "stale_baseline": 30,
    "exit_code": 1
  },
  "fixture_validation": {
    "status": "passed",
    "passed": 4,
    "failed": 0,
    "message": "Detection patterns verified against 4 test fixtures"
  },
  "findings": [{"id":"spo-002-superglobals","severity":"error","impact":"HIGH","file":"dist/tests/irl/wp-security-audit-log/class-select2-wpws-irl.php","line":137,"message":"Direct superglobal manipulation (5 occurrences in lines 137-156)","code":"\t\t\tif ( ! isset( $_REQUEST['nonce'] ) || false === wp_verify_nonce( \\sanitize_text_field( \\wp_unslash( $_REQUEST['nonce'] ) ), 'wsal-select2-check' ) ) {","context":[{"line":134,"code":"\t\tpublic static function handle_ajax_call() {"},{"line":136,"code":"\t\t\t// Verify nonce."},{"line":138,"code":"\t\t\t\twp_send_json_error( esc_html__( 'Insecure request.', 'wp-security-audit-log' ) );"},{"line":139,"code":"\t\t\t}"}]},{"id":"spo-002-superglobals","severity":"error","impact":"HIGH","file":"dist/tests/irl/wp-security-audit-log/class-select2-wpws-irl.php","line":224,"message":"Direct superglobal manipulation","code":"\t\t\t * $query_params['paged'] = isset( $_REQUEST['page'] ) ? (int) $_REQUEST['page'] : 1;","context":[{"line":221,"code":"\t\t\t * Or use pagination:"},{"line":222,"code":"\t\t\t *"},{"line":223,"code":"\t\t\t * $query_params['number'] = 100;"},{"line":225,"code":"\t\t\t * $users = get_users( $query_params );"},{"line":226,"code":"\t\t\t *"},{"line":227,"code":"\t\t\t * DETECTION: âœ… PASS"}]},{"id":"spo-002-superglobals","severity":"error","impact":"HIGH","file":"dist/tests/irl/wp-security-audit-log/class-wp-security-audit-log-irl.php","line":232,"message":"Direct superglobal manipulation","code":"\t\t\t\t( defined( 'REST_REQUEST' ) && REST_REQUEST )","context":[{"line":229,"code":"\t\t */"},{"line":230,"code":"\t\tpublic static function is_rest_api() {"},{"line":231,"code":"\t\t\tif ("},{"line":233,"code":"\t\t\t\t|| ! empty( $_GET['rest_route'] ) // phpcs:ignore"},{"line":234,"code":"\t\t\t\t) {"},{"line":235,"code":"\t\t\t\t\treturn true;"}]},{"id":"spo-002-superglobals","severity":"error","impact":"HIGH","file":"dist/tests/irl/wp-security-audit-log/class-wp-security-audit-log-irl.php","line":329,"message":"Direct superglobal manipulation (6 occurrences in lines 329-343)","code":"\t\t\t\tif ( isset( $_REQUEST['action'] ) && isset( $_REQUEST['slug'] ) && 'update-plugin' === trim( \\sanitize_text_field( \\wp_unslash( $_REQUEST['action'] ) ) )","context":[{"line":326,"code":"\t\t\t\t);"},{"line":328,"code":"\t\t\t\t// Check if this plugin is being updated from the plugin list."},{"line":330,"code":"\t\t\t\t&& in_array( trim( \\sanitize_text_field( \\wp_unslash( $_REQUEST['slug'] ) ) ), $acceptable_slugs ) ) {"},{"line":331,"code":"\t\t\t\t\treturn false;"},{"line":332,"code":"\t\t\t\t}"}]},{"id":"spo-002-superglobals","severity":"error","impact":"HIGH","file":"dist/tests/irl/wp-security-audit-log/class-wp-security-audit-log-irl.php","line":356,"message":"Direct superglobal manipulation (3 occurrences in lines 356-358)","code":"\t\t\t\tif ( isset( $_REQUEST['action'] ) && 'do-plugin-upgrade' === trim( \\sanitize_text_field( \\wp_unslash( $_REQUEST['action'] ) ) ) ) {","context":[{"line":353,"code":"\t\t\t\t}"},{"line":355,"code":"\t\t\t\t// Check if this plugin is being updated from the WordPress updated screen (update-core.php)."},{"line":357,"code":"\t\t\t\t\tif ( isset( $_REQUEST['checked'] ) ) {"},{"line":358,"code":"\t\t\t\t\t\t$selected_plugins = $_REQUEST['checked']; // phpcs:ignore WordPress.Security.ValidatedSanitizedInput.MissingUnslash, WordPress.Security.ValidatedSanitizedInput.InputNotSanitized"},{"line":359,"code":"\t\t\t\t\t\tif ( ! empty( $selected_plugins ) ) {"}]},{"id":"spo-002-superglobals","severity":"error","impact":"HIGH","file":"dist/tests/irl/wp-security-audit-log/class-wp-security-audit-log-irl.php","line":836,"message":"Direct superglobal manipulation (5 occurrences in lines 836-841)","code":"\t\t\t// Filter $_POST array for security.","context":[{"line":833,"code":"\t\t\t\tdie();"},{"line":834,"code":"\t\t\t}"},{"line":837,"code":"\t\t\t$post_array = filter_input_array( INPUT_POST );"},{"line":839,"code":"\t\t\t$disable_nonce    = ( isset( $_POST['disable_nonce'] ) ) ? \\sanitize_text_field( \\wp_unslash( $_POST['disable_nonce'] ) ) : null;"}]},{"id":"spo-002-superglobals","severity":"error","impact":"HIGH","file":"dist/tests/irl/wp-security-audit-log/class-wp-security-audit-log-irl.php","line":904,"message":"Direct superglobal manipulation (2 occurrences in lines 904-905)","code":"\t\t\t$disable_nonce = ( isset( $_POST['disable_nonce'] ) ) ? \\sanitize_text_field( \\wp_unslash( $_POST['disable_nonce'] ) ) : null;","context":[{"line":901,"code":"\t\t\t\tdie();"},{"line":902,"code":"\t\t\t}"},{"line":905,"code":"\t\t\t$code          = ( isset( $_POST['code'] ) ) ? \\sanitize_text_field( \\wp_unslash( $_POST['code'] ) ) : null;"},{"line":907,"code":"\t\t\tif ( ! isset( $disable_nonce ) || ! \\wp_verify_nonce( $disable_nonce, 'disable-alert-nonce' . $code ) ) {"}]},{"id":"spo-002-superglobals","severity":"error","impact":"HIGH","file":"dist/tests/irl/wp-security-audit-log/class-wp-security-audit-log-irl.php","line":1224,"message":"Direct superglobal manipulation (3 occurrences in lines 1224-1238)","code":"\t\t\t * ISSUE: Direct read of $_REQUEST['pagenow'] without sanitization","context":[{"line":1221,"code":"\t\t\t/**"},{"line":1222,"code":"\t\t\t * âš ï¸ ANTI-PATTERN: unsanitized-superglobal-read (HIGH)"},{"line":1223,"code":"\t\t\t *"},{"line":1225,"code":"\t\t\t * LINE: 1222 (original: 1196)"},{"line":1226,"code":"\t\t\t * SEVERITY: HIGH"},{"line":1227,"code":"\t\t\t *"}]},{"id":"spo-002-superglobals","severity":"error","impact":"HIGH","file":"dist/tests/irl/wp-security-audit-log/class-wp-security-audit-log-irl.php","line":1249,"message":"Direct superglobal manipulation (4 occurrences in lines 1249-1261)","code":"\t\t\t * && isset( $_REQUEST['pagenow'] )","context":[{"line":1246,"code":"\t\t\t * FIX:"},{"line":1247,"code":"\t\t\t * Sanitize before comparison:"},{"line":1248,"code":"\t\t\t *"},{"line":1250,"code":"\t\t\t * && 'plugins' === sanitize_text_field( wp_unslash( $_REQUEST['pagenow'] ) )"},{"line":1251,"code":"\t\t\t *"},{"line":1252,"code":"\t\t\t * Or use filter_input():"}]},{"id":"unsanitized-superglobal-read","severity":"error","impact":"HIGH","file":"dist/tests/irl/wp-security-audit-log/class-select2-wpws-irl.php","line":224,"message":"Unsanitized superglobal access","code":"\t\t\t * $query_params['paged'] = isset( $_REQUEST['page'] ) ? (int) $_REQUEST['page'] : 1;","context":[{"line":221,"code":"\t\t\t * Or use pagination:"},{"line":222,"code":"\t\t\t *"},{"line":223,"code":"\t\t\t * $query_params['number'] = 100;"},{"line":225,"code":"\t\t\t * $users = get_users( $query_params );"},{"line":226,"code":"\t\t\t *"},{"line":227,"code":"\t\t\t * DETECTION: âœ… PASS"}]},{"id":"unsanitized-superglobal-read","severity":"error","impact":"HIGH","file":"dist/tests/irl/wp-security-audit-log/class-wp-security-audit-log-irl.php","line":343,"message":"Unsanitized superglobal access","code":"\t\t\t\t\t$post_id    = (int) $_REQUEST['package'];","context":[{"line":340,"code":"\t\t\t\t\t *"},{"line":341,"code":"\t\t\t\t\t * @see File_Upload_Upgrader::__construct()"},{"line":342,"code":"\t\t\t\t\t */"},{"line":344,"code":"\t\t\t\t\t$attachment = \\get_post( $post_id );"},{"line":345,"code":"\t\t\t\t\tif ( ! empty( $attachment ) ) {"},{"line":346,"code":"\t\t\t\t\t\t$filename = $attachment->post_title;"}]},{"id":"unsanitized-superglobal-read","severity":"error","impact":"HIGH","file":"dist/tests/irl/wp-security-audit-log/class-wp-security-audit-log-irl.php","line":358,"message":"Unsanitized superglobal access","code":"\t\t\t\t\t\t$selected_plugins = $_REQUEST['checked']; // phpcs:ignore WordPress.Security.ValidatedSanitizedInput.MissingUnslash, WordPress.Security.ValidatedSanitizedInput.InputNotSanitized","context":[{"line":355,"code":"\t\t\t\t// Check if this plugin is being updated from the WordPress updated screen (update-core.php)."},{"line":356,"code":"\t\t\t\tif ( isset( $_REQUEST['action'] ) && 'do-plugin-upgrade' === trim( \\sanitize_text_field( \\wp_unslash( $_REQUEST['action'] ) ) ) ) {"},{"line":357,"code":"\t\t\t\t\tif ( isset( $_REQUEST['checked'] ) ) {"},{"line":359,"code":"\t\t\t\t\t\tif ( ! empty( $selected_plugins ) ) {"},{"line":360,"code":"\t\t\t\t\t\t\tforeach ( $selected_plugins as $selected_plugin ) {"},{"line":361,"code":"\t\t\t\t\t\t\t\tif ( 'wp-security-audit-log.php' === basename( trim( \\sanitize_text_field( \\wp_unslash( $selected_plugin ) ) ) ) ) {"}]},{"id":"unsanitized-superglobal-read","severity":"error","impact":"HIGH","file":"dist/tests/irl/wp-security-audit-log/class-wp-security-audit-log-irl.php","line":1224,"message":"Unsanitized superglobal access","code":"\t\t\t * ISSUE: Direct read of $_REQUEST['pagenow'] without sanitization","context":[{"line":1221,"code":"\t\t\t/**"},{"line":1222,"code":"\t\t\t * âš ï¸ ANTI-PATTERN: unsanitized-superglobal-read (HIGH)"},{"line":1223,"code":"\t\t\t *"},{"line":1225,"code":"\t\t\t * LINE: 1222 (original: 1196)"},{"line":1226,"code":"\t\t\t * SEVERITY: HIGH"},{"line":1227,"code":"\t\t\t *"}]},{"id":"unsanitized-superglobal-read","severity":"error","impact":"HIGH","file":"dist/tests/irl/wp-security-audit-log/class-wp-security-audit-log-irl.php","line":1229,"message":"Unsanitized superglobal access","code":"\t\t\t * - $_REQUEST['pagenow'] is compared directly without sanitization","context":[{"line":1226,"code":"\t\t\t * SEVERITY: HIGH"},{"line":1227,"code":"\t\t\t *"},{"line":1228,"code":"\t\t\t * PROBLEM:"},{"line":1230,"code":"\t\t\t * - Type juggling vulnerability: attacker can send array or object"},{"line":1231,"code":"\t\t\t * - String comparison with unsanitized input"},{"line":1232,"code":"\t\t\t * - Could bypass security checks with crafted input"}]},{"id":"unsanitized-superglobal-read","severity":"error","impact":"HIGH","file":"dist/tests/irl/wp-security-audit-log/class-wp-security-audit-log-irl.php","line":1238,"message":"Unsanitized superglobal access","code":"\t\t\t * - Comparison: 'plugins' === $_REQUEST['pagenow']","context":[{"line":1235,"code":"\t\t\t * - This function hides certain plugins from the plugins list"},{"line":1236,"code":"\t\t\t * - Called during AJAX requests on the plugins page"},{"line":1237,"code":"\t\t\t * - The isset() check doesn't prevent type juggling attacks"},{"line":1239,"code":"\t\t\t *"},{"line":1240,"code":"\t\t\t * ATTACK SCENARIO:"},{"line":1241,"code":"\t\t\t * 1. Attacker sends AJAX request with pagenow[]=plugins (array)"}]},{"id":"unsanitized-superglobal-read","severity":"error","impact":"HIGH","file":"dist/tests/irl/wp-security-audit-log/class-wp-security-audit-log-irl.php","line":1261,"message":"Unsanitized superglobal access","code":"\t\t\t&& ! ( \\wp_doing_ajax() && isset( $_REQUEST['pagenow'] ) && 'plugins' === $_REQUEST['pagenow'] ) ) {","context":[{"line":1258,"code":"\t\t\t * Scanner correctly identifies this pattern."},{"line":1259,"code":"\t\t\t */"},{"line":1260,"code":"\t\t\tif ( 'plugins.php' !== $pagenow"},{"line":1263,"code":"\t\t\t\treturn $plugins;"},{"line":1264,"code":"\t\t\t}"}]},{"id":"wpdb-query-no-prepare","severity":"error","impact":"CRITICAL","file":"dist/tests/irl/wp-security-audit-log/class-migration-irl.php","line":206,"message":"Direct database query without $wpdb->prepare()","code":"\t\t\t * $plugin_options = $wpdb->get_results(","context":[{"line":203,"code":"\t\t\t * FIX:"},{"line":204,"code":"\t\t\t * Use $wpdb->prepare() with proper placeholders:"},{"line":205,"code":"\t\t\t *"},{"line":207,"code":"\t\t\t *     $wpdb->prepare("},{"line":208,"code":"\t\t\t *         \"SELECT option_name FROM {$wpdb->options} WHERE option_name LIKE %s\","},{"line":209,"code":"\t\t\t *         $wpdb->esc_like( 'wsal_local_files_' ) . '%'"}]},{"id":"wpdb-query-no-prepare","severity":"error","impact":"CRITICAL","file":"dist/tests/irl/wp-security-audit-log/class-migration-irl.php","line":226,"message":"Direct database query without $wpdb->prepare()","code":"\t\t\t$plugin_options = $wpdb->get_results( \"SELECT option_name FROM $wpdb->options WHERE option_name LIKE 'wsal_local_files_%'\" );","context":[{"line":223,"code":"\t\t\t * DETECTION: âœ… PASS"},{"line":224,"code":"\t\t\t * Scanner correctly identifies this pattern."},{"line":225,"code":"\t\t\t */"},{"line":227,"code":"\t\t\tif ( ! empty( $plugin_options ) ) {"},{"line":228,"code":"\t\t\t\tforeach ( $plugin_options as $option ) {"},{"line":229,"code":"\t\t\t\t\tWP_Helper::delete_global_option( $option->option_name );"}]},{"id":"wpdb-query-no-prepare","severity":"error","impact":"CRITICAL","file":"dist/tests/irl/wp-security-audit-log/class-migration-irl.php","line":520,"message":"Direct database query without $wpdb->prepare()","code":"\t\t\t\t\t$notifications = $wpdb->get_results( $prepared_query ); // phpcs:ignore WordPress.DB.PreparedSQL.NotPrepared","context":[{"line":517,"code":"\t\t\t\t\t\t$opt_prefix . '%%'"},{"line":518,"code":"\t\t\t\t\t);"},{"line":522,"code":"\t\t\t\t\tif ( ! $mirrors_in_use && ! empty( $notifications ) ) {"}]},{"id":"wpdb-query-no-prepare","severity":"error","impact":"CRITICAL","file":"dist/tests/irl/wp-security-audit-log/class-migration-irl.php","line":559,"message":"Direct database query without $wpdb->prepare()","code":"\t\t\t\t\t$wpdb->query( $alter_query ); // phpcs:ignore","context":[{"line":556,"code":"\t\t\t\t\t$alter_query = 'ALTER TABLE `' . $wpdb->base_prefix . 'wsal_sessions` CHANGE `session_token` `session_token` VARCHAR(128)"},{"line":557,"code":"\t\t\t\t\tNOT NULL;';"},{"line":560,"code":"\t\t\t\t}"},{"line":561,"code":"\t\t\t}"}]},{"id":"wpdb-query-no-prepare","severity":"error","impact":"CRITICAL","file":"dist/tests/irl/wp-security-audit-log/class-migration-irl.php","line":693,"message":"Direct database query without $wpdb->prepare()","code":"\t\t\t\t\t$wpdb->query( $alter_query ); // phpcs:ignore","context":[{"line":690,"code":"\t\t\t\tif ( ! $column_exists || $column_exists_id ) {"},{"line":691,"code":"\t\t\t\t\t$alter_query = 'DROP TABLE `' . $wpdb->base_prefix . 'wsal_sessions`;';"},{"line":695,"code":"\t\t\t\t\tif ( \\class_exists( '\\WSAL\\Adapter\\User_Sessions' ) ) {"},{"line":696,"code":"\t\t\t\t\t\t\\WSAL\\Adapter\\User_Sessions::create_table();"}]},{"id":"spo-004-missing-cap-check","severity":"error","impact":"HIGH","file":"dist/tests/irl/wp-security-audit-log/class-wp-security-audit-log-irl.php","line":201,"message":"Admin function/hook missing capability check near admin context","code":"\t\t\t\\add_action( 'admin_print_scripts', array( WP_Helper::class, 'hide_unrelated_notices' ) );","context":[{"line":199,"code":"\t\t\tMainWP_Addon::init();"},{"line":200,"code":"\t\t\t// Hide all unrelated to the plugin notices on the plugin admin pages."},{"line":203,"code":"\t\t\t\\add_action("},{"line":204,"code":"\t\t\t\t'after_setup_theme',"}]},{"id":"spo-004-missing-cap-check","severity":"error","impact":"HIGH","file":"dist/tests/irl/wp-security-audit-log/class-wp-security-audit-log-irl.php","line":218,"message":"Admin function/hook missing capability check near admin context (2 occurrences in lines 218-220)","code":"\t\t\t\\add_action( 'admin_init', array( __CLASS__, 'wsal_plugin_redirect' ) );","context":[{"line":215,"code":"\t\t\t\t0"},{"line":216,"code":"\t\t\t);"},{"line":220,"code":"\t\t\t\\add_action( 'admin_init', array( __CLASS__, 'maybe_sync_premium_freemius' ) );"},{"line":221,"code":"\t\t}"}]},{"id":"spo-004-missing-cap-check","severity":"error","impact":"HIGH","file":"dist/tests/irl/wp-security-audit-log/class-wp-security-audit-log-irl.php","line":305,"message":"Admin function/hook missing capability check near admin context","code":"\t\t\t\t\\add_action( 'all_admin_notices', array( Metadata_Migration_440::class, 'maybe_display_progress_admin_notice' ) );","context":[{"line":302,"code":"\t\t\t\t\tnew Metadata_Migration_440( $connection_name );"},{"line":303,"code":"\t\t\t\t}"},{"line":306,"code":"\t\t\t}"},{"line":308,"code":"\t\t\tself::init_hooks();"}]},{"id":"spo-004-missing-cap-check","severity":"error","impact":"HIGH","file":"dist/tests/irl/wp-security-audit-log/class-wp-security-audit-log-irl.php","line":421,"message":"Admin function/hook missing capability check near admin context","code":"\t\t\t\\add_action( 'admin_footer', array( __CLASS__, 'render_footer' ) );","context":[{"line":418,"code":"\t\t\t\\add_action( 'shutdown', array( __CLASS__, 'close_external_connection' ), 999 );"},{"line":420,"code":"\t\t\t// Render wsal footer."},{"line":423,"code":"\t\t\t// Handle admin Disable Custom Field."},{"line":424,"code":"\t\t\t\\add_action( 'wp_ajax_AjaxDisableCustomField', array( __CLASS__, 'ajax_disable_custom_field' ) );"}]},{"id":"spo-004-missing-cap-check","severity":"error","impact":"HIGH","file":"dist/tests/irl/wp-security-audit-log/class-wp-security-audit-log-irl.php","line":771,"message":"Admin function/hook missing capability check near admin context","code":"\t\t\t\t\t\\add_action( 'admin_head', array( __CLASS__, 'hide_plugin' ) );","context":[{"line":769,"code":"\t\t\t\t// Hide plugin."},{"line":770,"code":"\t\t\t\tif ( Settings_Helper::get_boolean_option_value( 'hide-plugin' ) ) {"},{"line":772,"code":"\t\t\t\t\t\\add_filter( 'all_plugins', array( __CLASS__, 'wsal_hide_plugin' ) );"},{"line":773,"code":"\t\t\t\t}"},{"line":774,"code":"\t\t\t}"}]},{"id":"spo-004-missing-cap-check","severity":"error","impact":"HIGH","file":"dist/tests/irl/wp-security-audit-log/class-wp-security-audit-log-irl.php","line":1351,"message":"Admin function/hook missing capability check near admin context","code":"\t\tprivate static function is_admin_blocking_plugins_support_enabled() {","context":[{"line":1348,"code":"\t\t * @see https://trello.com/c/1OCd5iKc/589-wieserdk-al4mwp-cannot-retrieve-events-when-admin-url-is-changed"},{"line":1349,"code":"\t\t * @return bool"},{"line":1350,"code":"\t\t */"},{"line":1353,"code":"\t\t\t// Only meant for 404 pages, but may run before is_404 can be used."},{"line":1354,"code":"\t\t\t$is_404 = ! did_action( 'wp' ) || is_404();"}]},{"id":"spo-004-missing-cap-check","severity":"error","impact":"HIGH","file":"dist/tests/irl/wp-security-audit-log/class-wp-security-audit-log-irl.php","line":1455,"message":"Admin function/hook missing capability check near admin context","code":"\t\tpublic static function get_plugin_admin_url_page() {","context":[{"line":1452,"code":"\t\t *"},{"line":1453,"code":"\t\t * @since 5.1.1"},{"line":1454,"code":"\t\t */"},{"line":1456,"code":"\t\t\treturn \\add_query_arg( 'page', 'wsal-auditlog', \\network_admin_url( 'admin.php' ) );"},{"line":1457,"code":"\t\t}"}]},{"id":"get-users-no-limit","severity":"error","impact":"CRITICAL","file":"dist/tests/irl/wp-security-audit-log/class-select2-wpws-irl.php","line":25,"message":"get_users() without 'number' limit can fetch ALL users","code":" * The get_users() calls are used for AJAX search and initial data loading.","context":[{"line":22,"code":" *"},{"line":23,"code":" * CONTEXT:"},{"line":24,"code":" * This is a Select2 helper class for WordPress user selection dropdowns."},{"line":26,"code":" * On large sites (10k+ users), unbounded queries can cause memory issues."},{"line":27,"code":" */"}]},{"id":"get-users-no-limit","severity":"error","impact":"CRITICAL","file":"dist/tests/irl/wp-security-audit-log/class-select2-wpws-irl.php","line":159,"message":"get_users() without 'number' limit can fetch ALL users","code":"\t\t\t\t\t$result = self::get_users( $search_term );","context":[{"line":156,"code":"\t\t\t$search_term = trim( sanitize_text_field( wp_unslash( $_REQUEST['term'] ) ) );"},{"line":157,"code":"\t\t\tswitch ( $entity ) {"},{"line":158,"code":"\t\t\t\tcase 'user':"},{"line":160,"code":"\t\t\t\t\tbreak;"},{"line":161,"code":"\t\t\t\tcase 'post':"},{"line":162,"code":"\t\t\t\t\t$result = self::get_posts( $search_term );"}]},{"id":"get-users-no-limit","severity":"error","impact":"CRITICAL","file":"dist/tests/irl/wp-security-audit-log/class-select2-wpws-irl.php","line":185,"message":"get_users() without 'number' limit can fetch ALL users","code":"\t\tpublic static function get_users( $search_term = null ) {","context":[{"line":182,"code":"\t\t *"},{"line":183,"code":"\t\t * @since 4.5.1"},{"line":184,"code":"\t\t */"},{"line":186,"code":"\t\t\t$result       = array();"},{"line":187,"code":"\t\t\t$query_params = array();"},{"line":188,"code":"\t\t\tif ( ! is_null( $search_term ) ) {"}]},{"id":"get-users-no-limit","severity":"error","impact":"CRITICAL","file":"dist/tests/irl/wp-security-audit-log/class-select2-wpws-irl.php","line":225,"message":"get_users() without 'number' limit can fetch ALL users","code":"\t\t\t * $users = get_users( $query_params );","context":[{"line":222,"code":"\t\t\t *"},{"line":223,"code":"\t\t\t * $query_params['number'] = 100;"},{"line":224,"code":"\t\t\t * $query_params['paged'] = isset( $_REQUEST['page'] ) ? (int) $_REQUEST['page'] : 1;"},{"line":226,"code":"\t\t\t *"},{"line":227,"code":"\t\t\t * DETECTION: âœ… PASS"},{"line":228,"code":"\t\t\t * Scanner correctly identifies this pattern."}]},{"id":"get-users-no-limit","severity":"error","impact":"CRITICAL","file":"dist/tests/irl/wp-security-audit-log/class-select2-wpws-irl.php","line":230,"message":"get_users() without 'number' limit can fetch ALL users","code":"\t\t\t$users = get_users( $query_params );","context":[{"line":227,"code":"\t\t\t * DETECTION: âœ… PASS"},{"line":228,"code":"\t\t\t * Scanner correctly identifies this pattern."},{"line":229,"code":"\t\t\t */"},{"line":232,"code":"\t\t\tif ( empty( $users ) ) {"},{"line":233,"code":"\t\t\t\treturn $result;"}]},{"id":"get-users-no-limit","severity":"error","impact":"CRITICAL","file":"dist/tests/irl/wp-security-audit-log/class-select2-wpws-irl.php","line":434,"message":"get_users() without 'number' limit can fetch ALL users","code":"\t\t\t\t\t\t\t *     $args['data'] = self::get_users();","context":[{"line":431,"code":"\t\t\t\t\t\t\t * Even with threshold, add a hard limit:"},{"line":432,"code":"\t\t\t\t\t\t\t *"},{"line":433,"code":"\t\t\t\t\t\t\t * if ( $users_count <= $threshold && $users_count <= 1000 ) {"},{"line":435,"code":"\t\t\t\t\t\t\t * }"},{"line":436,"code":"\t\t\t\t\t\t\t *"},{"line":437,"code":"\t\t\t\t\t\t\t * Or modify get_users() to accept a limit parameter:"}]},{"id":"get-users-no-limit","severity":"error","impact":"CRITICAL","file":"dist/tests/irl/wp-security-audit-log/class-select2-wpws-irl.php","line":437,"message":"get_users() without 'number' limit can fetch ALL users","code":"\t\t\t\t\t\t\t * Or modify get_users() to accept a limit parameter:","context":[{"line":434,"code":"\t\t\t\t\t\t\t *     $args['data'] = self::get_users();"},{"line":435,"code":"\t\t\t\t\t\t\t * }"},{"line":436,"code":"\t\t\t\t\t\t\t *"},{"line":438,"code":"\t\t\t\t\t\t\t *"},{"line":439,"code":"\t\t\t\t\t\t\t * $args['data'] = self::get_users( null, 1000 );"},{"line":440,"code":"\t\t\t\t\t\t\t *"}]},{"id":"get-users-no-limit","severity":"error","impact":"CRITICAL","file":"dist/tests/irl/wp-security-audit-log/class-select2-wpws-irl.php","line":439,"message":"get_users() without 'number' limit can fetch ALL users","code":"\t\t\t\t\t\t\t * $args['data'] = self::get_users( null, 1000 );","context":[{"line":436,"code":"\t\t\t\t\t\t\t *"},{"line":437,"code":"\t\t\t\t\t\t\t * Or modify get_users() to accept a limit parameter:"},{"line":438,"code":"\t\t\t\t\t\t\t *"},{"line":440,"code":"\t\t\t\t\t\t\t *"},{"line":441,"code":"\t\t\t\t\t\t\t * DETECTION: âœ… PASS"},{"line":442,"code":"\t\t\t\t\t\t\t * Scanner correctly identifies this pattern."}]},{"id":"get-users-no-limit","severity":"error","impact":"CRITICAL","file":"dist/tests/irl/wp-security-audit-log/class-select2-wpws-irl.php","line":444,"message":"get_users() without 'number' limit can fetch ALL users","code":"\t\t\t\t\t\t\t$args['data'] = self::get_users();","context":[{"line":441,"code":"\t\t\t\t\t\t\t * DETECTION: âœ… PASS"},{"line":442,"code":"\t\t\t\t\t\t\t * Scanner correctly identifies this pattern."},{"line":443,"code":"\t\t\t\t\t\t\t */"},{"line":445,"code":"\t\t\t\t\t\t\tunset( $args['data-type'] );"},{"line":446,"code":"\t\t\t\t\t\t}"},{"line":447,"code":"\t\t\t\t\t}"}]},{"id":"transient-no-expiration","severity":"warning","impact":"MEDIUM","file":"dist/tests/irl/wp-security-audit-log/class-wp-security-audit-log-irl.php","line":165,"message":"Transient may be missing expiration parameter","code":"\t\t\t\tset_transient( 'wsal_deactivate_plugins', true );","context":[{"line":162,"code":"\t\t\tif ( method_exists( 'WSAL\\Controllers\\Plugin_Extensions', 'deactivate_plugins' ) ) {"},{"line":163,"code":"\t\t\t\tPlugin_Extensions::deactivate_plugins();"},{"line":164,"code":"\t\t\t} else {"},{"line":166,"code":"\t\t\t}"},{"line":168,"code":"\t\t\tstatic $instance = null;"}]}],
  "checks": [{"name":"Debug code in production","impact":"CRITICAL","status":"passed","findings_count":0},{"name":"Sensitive data in localStorage/sessionStorage","impact":"CRITICAL","status":"passed","findings_count":0},{"name":"Serialization of objects to client storage","impact":"CRITICAL","status":"passed","findings_count":0},{"name":"User input in RegExp without escaping (HCC-008)","impact":"MEDIUM","status":"passed","findings_count":0},{"name":"Direct superglobal manipulation","impact":"HIGH","status":"failed","findings_count":30},{"name":"Unsanitized superglobal read ($_GET/$_POST)","impact":"HIGH","status":"failed","findings_count":7},{"name":"Insecure data deserialization","impact":"CRITICAL","status":"passed","findings_count":0},{"name":"Direct database queries without $wpdb->prepare()","impact":"CRITICAL","status":"failed","findings_count":5},{"name":"Admin functions without capability checks","impact":"HIGH","status":"failed","findings_count":8},{"name":"Unbounded AJAX polling (setInterval + fetch/ajax)","impact":"HIGH","status":"passed","findings_count":0},{"name":"Expensive WP functions in polling intervals (HCC-005)","impact":"HIGH","status":"passed","findings_count":0},{"name":"REST endpoints without pagination/limits","impact":"CRITICAL","status":"passed","findings_count":0},{"name":"wp_ajax handlers without nonce validation","impact":"HIGH","status":"passed","findings_count":0},{"name":"Unbounded posts_per_page","impact":"CRITICAL","status":"passed","findings_count":0},{"name":"Unbounded numberposts","impact":"CRITICAL","status":"passed","findings_count":0},{"name":"nopaging => true","impact":"CRITICAL","status":"passed","findings_count":0},{"name":"Unbounded wc_get_orders limit","impact":"CRITICAL","status":"passed","findings_count":0},{"name":"WooCommerce Subscriptions queries without limits","impact":"MEDIUM","status":"passed","findings_count":0},{"name":"get_users without number limit","impact":"CRITICAL","status":"failed","findings_count":9},{"name":"get_terms without number limit","impact":"CRITICAL","status":"passed","findings_count":0},{"name":"pre_get_posts forcing unbounded queries","impact":"CRITICAL","status":"passed","findings_count":0},{"name":"Unbounded SQL on wp_terms/wp_term_taxonomy","impact":"HIGH","status":"passed","findings_count":0},{"name":"Unvalidated cron intervals","impact":"HIGH","status":"passed","findings_count":0},{"name":"Timezone-sensitive patterns (current_time/date)","impact":"LOW","status":"passed","findings_count":0},{"name":"Randomized ordering (ORDER BY RAND)","impact":"HIGH","status":"passed","findings_count":0},{"name":"LIKE queries with leading wildcards","impact":"MEDIUM","status":"passed","findings_count":0},{"name":"Potential N+1 patterns (meta in loops)","impact":"CRITICAL","status":"passed","findings_count":0},{"name":"WooCommerce N+1 patterns (WC functions in loops)","impact":"HIGH","status":"passed","findings_count":0},{"name":"Transients without expiration","impact":"MEDIUM","status":"failed","findings_count":1},{"name":"Script/style versioning with time()","impact":"MEDIUM","status":"passed","findings_count":0},{"name":"file_get_contents with external URLs","impact":"HIGH","status":"passed","findings_count":0},{"name":"HTTP requests without timeout","impact":"MEDIUM","status":"passed","findings_count":0},{"name":"Disallowed PHP short tags","impact":"MEDIUM","status":"passed","findings_count":0}]
}

ðŸ“Š HTML Report: /Users/noelsaw/Documents/GH Repos/wp-code-check/dist/reports/2026-01-01-053210-UTC.html
